(self.webpackChunkdemocosmos=self.webpackChunkdemocosmos||[]).push([[65531],{65531:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var a=n(4942),r=n(1413),i=n(37762),s=n(29439),o=n(72791),c=n(57689),u=n(80758),l=n(37260),f=n(91062),d=n(84053),g=n(54716),m=n(12616),v=n(27132),h=n(94342),p=n(51953),y=n(32012),x=n(80871),b=n(49010),Z=n(30643),S=n(77047),k=n(22426),T=function(e){return"0".concat(e).slice(-2)},j=function(e,t,n,a,r){if("string"===typeof t){if(a){var i=function(e,t){if("string"!==typeof t)return null;var n=e,a=t.split(".");for(var r in a){var i=a[r],s=i.indexOf("(");if(-1===s){if("undefined"===typeof n[i])return null;n=n[i]}else{var o=parseInt(i.substring(s+1,i.length-1),10),c=n[i.substring(0,s)];if(!(c&&Array.isArray(c)&&c.length>=o))return null;n=c[o-1]}}return n}(a,t);if(i===r||"".concat(i)==="".concat(r)||null===i&&""===r)return}var s=t.lastIndexOf(".");if(-1!==s)if(n){var o={},c=t.substring(0,s);o[t.substring(s+1)]=r;var u=c.indexOf("(");if(-1===u)n.push({instruction:"UPDATE",target:c,content:o});else{var l=c.substring(u+1,c.length-1);c=c.substring(0,u),n.push({instruction:"UPDATE",target:c,listIndex:parseInt(l,10),content:o})}}else!function(e,t,n){if("string"===typeof t)for(var a=t.split("."),r=e,i=0;i<a.length;i++){var s=a[i],o=s.indexOf("(");if(-1===o)i<a.length-1?"undefined"===typeof r[s]&&(r[s]={}):r[s]=n,r=r[s];else{var c=parseInt(s.substring(o+1,s.length-1));"undefined"===typeof r[s=s.substring(0,o)]&&(r[s]=[]);for(var u=r[s].length;u<c;u++)r[s].push({});r=r[s][c-1]}}}(e,t,r);else e[t]=r}},I=function(e,t,n,a){var r,s,o=(0,i.Z)(e.elements);try{for(o.s();!(r=o.n()).done;){var c=r.value;if("INPUT"===c.tagName||"TEXTAREA"===c.tagName||"SELECT"===c.tagName){var u=c.getAttribute("data-ref");if(null!==u&&"pyID"!==u)if("INPUT"===c.tagName){var l=c.getAttribute("type");if("checkbox"===l)j(t,u,n,a,c.checked);else if("radio"===l)c.checked&&j(t,u,n,a,c.value);else if("tel"===l){var f=c.value;"SELECT"===c.parentNode.firstElementChild.tagName&&"field-countrycode"===c.parentNode.firstElementChild.className&&(f=c.parentNode.firstElementChild.value+f),j(t,u,n,a,f)}else if("date"===l){var d=void 0;c.valueAsDate&&(d=new Date(c.valueAsDate)),d&&d instanceof Date&&d.getTime()===d.getTime()||(d=new Date(c.value)),d&&d instanceof Date&&d.getTime()===d.getTime()?(d=new Date(d.getTime()+6e4*d.getTimezoneOffset()),j(t,u,n,a,"".concat(T(d.getMonth()+1),"/").concat(T(d.getDate()),"/").concat(d.getFullYear()))):j(t,u,n,a,c.value)}else j(t,u,n,a,c.value)}else j(t,u,n,a,c.value)}}}catch(p){o.e(p)}finally{o.f()}if(e&&e.querySelectorAll)for(var g=e.querySelectorAll("[contenteditable]"),m=0;m<g.length;m++){var v=g[m],h=v.getAttribute("data-ref");j(t,h,n,a,(s=v.innerHTML)&&"string"===typeof s?s.replace(/[&<>'"]/g,(function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;","(":"&#40;",")":"&#41;",'"':"&quot;"}[e]||e})):"")}},C=n(80184);function E(){var e=(0,c.UO)().caseid,t=(0,o.useState)(!1),T=(0,s.Z)(t,2),j=T[0],E=T[1],w=(0,o.useState)(),P=(0,s.Z)(w,2),A=P[0],D=P[1],N=(0,o.useState)(!0),U=(0,s.Z)(N,2),R=U[0],O=U[1],F=(0,o.useState)(""),L=(0,s.Z)(F,2),q=L[0],z=L[1],M=(0,o.useState)(""),W=(0,s.Z)(M,2),_=W[0],B=W[1],Q=(0,o.useState)("tab-0"),$=(0,s.Z)(Q,2),G=$[0],H=$[1],J=(0,o.useState)([]),V=(0,s.Z)(J,2),X=V[0],Y=V[1],K=(0,o.useState)([]),ee=(0,s.Z)(K,2),te=ee[0],ne=ee[1],ae=(0,o.useState)({}),re=(0,s.Z)(ae,2),ie=re[0],se=re[1],oe=(0,o.useState)(),ce=(0,s.Z)(oe,2),ue=ce[0],le=ce[1];(0,o.useEffect)((function(){var e=!0;return""!==q&&(0,b.rQ)("assignments",q).then((function(t){if(e&&t.uiResources){var n=t.uiResources.root.config.name;B(t.data.caseInfo.content.pyViewName),le((0,C.jsx)(k.default,{children:(0,S.e)(t.uiResources.resources.views[n],!1,"",t)}))}})),function(){e=!1}}),[q]);var fe=function(e){var t=e.onSubmit,n=e.onCancel;return(0,C.jsx)(u.Z,{actions:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(l.ZP,{onClick:n,children:"Cancel"}),(0,C.jsx)(l.ZP,{variant:"primary",onClick:t,children:"Submit"})]}),children:ue})},de=(0,o.useCallback)((function(e){if(!A||!A.uiResources.resources.views.pyDetails)return[];var t,n=(0,i.Z)(A.uiResources.resources.views.pyDetails[0].children);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.name===e)return a}}catch(r){n.e(r)}finally{n.f()}return[]}),[A]);(0,o.useEffect)((function(){if(A){var t=de("Utilities");Y(t.children.map((function(t,a){try{var r=(0,o.lazy)((function(){return n(61413)("./".concat(t.type)).catch((function(e){console.error("An error has occured",e)}))}));return(0,C.jsx)(o.Suspense,{fallback:(0,C.jsx)(f.Z,{placement:"local"}),children:(0,C.jsx)(r,{caseid:e,utilityCtx:ge})},"utility-".concat(a))}catch(i){return(0,C.jsxs)("div",{children:["Utility ",t.type," not found"]},"utility-".concat(a))}})))}}),[A,e,de]),(0,o.useEffect)((function(){(0,b.rQ)("caseview",e).then((function(e){D(e),E(!0)}))}),[e]);var ge=function(e,t){se((function(n){return n[e]&&n[e].count===t.count?n:(0,r.Z)((0,r.Z)({},n),{},(0,a.Z)({},e,t))}))};(0,o.useEffect)((function(){if(A){var e=de("Utilities");ne(e.children.reduce((function(e,t){var n=t.type;return n&&ie[n]&&e.push(ie[n]),e}),[]))}}),[ie,A,de]);var me=function(e){return A.uiResources.resources.views.pyCaseSummary[0].children[e].children.map((function(e,t){return(0,Z.rz)(A,e),{id:"p-".concat(t),name:(0,Z.Te)(e),value:(0,Z.hW)(e)}}))};return j?(0,C.jsx)(x.Z,{caseId:e,heading:A?A.data.caseInfo.content.pyLabel:"",icon:(0,C.jsx)(h.ZP,{name:"polaris-solid"}),followed:!1,onFollowedChange:function(){},onEdit:function(){},summaryFields:{primary:me(0),secondary:me(1)},tabs:{items:de("Tabs").children.map((function(e,t){var n=e.config.label;return!n&&e.config.inheritedProps&&e.config.inheritedProps.length>0&&(n=e.config.inheritedProps[0]),{name:n="string"===typeof n?n.replace("@L ",""):"",id:"tab-".concat(t)}})),currentTabId:G,onClick:function(e){return H(e)}},tasks:A.data.caseInfo.assignments?(0,C.jsx)(p.Z,{name:"Tasks",count:A.data.caseInfo.assignments.length,items:A.data.caseInfo.assignments.filter((function(e,t){return!R||t<3})).map((function(t,n){return{avatar:(0,C.jsx)(d.ZP,{name:t.assigneeInfo.name,imageSrc:(0,b.$k)("operatorimage",t.assigneeInfo.image)}),name:t.name,meta:(0,C.jsx)(g.ZP,{items:[(0,C.jsxs)(m.Z,{variant:"secondary",children:["Task in ",e]}),(0,C.jsxs)(m.Z,{variant:"secondary",children:["Urgency ",t.urgency]})]}),actions:(0,C.jsx)(l.ZP,{variant:"primary",onClick:function(){z(t.links.open.href)},children:"Go"}),content:""!==q?(0,C.jsx)(fe,{onSubmit:function(e){var t={},n=[];I(e.target.closest("form"),t,n,A.data.caseInfo.content),(0,b.$S)("assignments",q.substring(1)+"/actions/"+_,JSON.stringify({content:t,pageInstructions:n})).then((function(e){if(e.uiResources){var t=e.uiResources.root.config.name;le((0,C.jsx)(k.default,{children:(0,S.e)(e.uiResources.resources.views[t],!1,"",e)})),D((function(t){return(0,r.Z)((0,r.Z)({},t),{},{data:e.data})}))}})),z("")},onCancel:function(){z("")}}):null}})),emptyPlaceholder:(0,C.jsx)(v.Z,{}),onExpandToggle:function(){O((function(e){return!e}))}}):null,stages:(0,C.jsx)(y.Z,{stages:A.data.caseInfo.stages.map((function(e){return{name:e.name,id:"stage-".concat(e.name),complete:"completed"===e.visited_status}})),current:"stage-".concat(A.data.caseInfo.stageLabel),caseTitle:"Stages"}),actions:A.data.caseInfo.availableActions.map((function(e,t){return{text:e.name,id:"action-".concat(t),onClick:function(){}}})),utilities:X,utilitiesSummaryItems:te}):(0,C.jsx)(f.Z,{placement:"global"})}},61413:function(e,t,n){var a={"./ErrorBoundary":[22426],"./ErrorBoundary.tsx":[22426],"./FileUtility":[39872,39872],"./FileUtility.tsx":[39872,39872],"./Followers":[68497,68497],"./Followers.tsx":[68497,68497],"./Pulse":[41387,78355,96241,41387],"./Pulse.tsx":[41387,78355,96241,41387],"./RelatedCases":[71029,71029],"./RelatedCases.tsx":[71029,71029],"./Stakeholders":[95751,16205,64654,95751],"./Stakeholders.tsx":[95751,16205,64654,95751],"./Tags":[94634,78355,94634],"./Tags.tsx":[94634,78355,94634],"./Worklist":[41903,55278],"./Worklist.tsx":[41903,55278]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=61413,e.exports=r}}]);
//# sourceMappingURL=65531.aad7aeae.chunk.js.map